!function(){window.Concertember=Ember.Application.create()}(),function(){Concertember.AllConcertController=Ember.ArrayController.extend({newConcert:{artist:"",venue:"",dateString:moment().format("DD.MM.YYYY")},actions:{addConcert:function(){var a=this.get("newConcert");if(a){var b=this.store.createRecord("concert",{artist:a.artist,venue:a.venue,date:a.dateString});b.save();{this.store.find("concerts","concerts_1").then(function(a){a.get("allConcerts").then(function(a){a.pushObject(b),a.save()})})}this.set("newConcert",{artist:"",venue:"",dateString:moment().format("DD.MM.YYYY")})}},removeConcert:function(a){a.deleteRecord(),a.save()}}})}(),function(){Concertember.ConcertController=Ember.ObjectController.extend({newConcert:{artist:"",venue:"",dateString:moment().format("DD.MM.YYYY")},actions:{addConcert:function(){var a=this.get("newConcert");if(a){if(_.isBlank(a.artist)||_.isBlank(a.venue)||_.isBlank(a.dateString))var b=this.store.createRecord("concert",{artist:a.artist,venue:a.venue,date:a.dateString});b.save();{this.store.find("concerts","concerts_1").then(function(a){a.get("allConcerts").then(function(a){a.pushObject(b),a.save()})})}this.set("newConcert",{artist:"",venue:"",dateString:moment().format("DD.MM.YYYY")})}},removeConcert:function(a){a.deleteRecord(),a.save()}}})}(),function(){Concertember.LoveConcertController=Ember.ArrayController.extend({newConcert:{artist:"",venue:"",dateString:moment().format("DD.MM.YYYY")},actions:{addConcert:function(){var a=this.get("newConcert");if(a){var b=this.store.createRecord("concert",{artist:a.artist,venue:a.venue,date:a.dateString});b.save();{this.store.find("concerts","concerts_1").then(function(a){a.get("allConcerts").then(function(a){a.pushObject(b),a.save()})})}this.set("newConcert",{artist:"",venue:"",dateString:moment().format("DD.MM.YYYY")})}},removeConcert:function(a){a.deleteRecord(),a.save()}}})}(),function(){Concertember.MaybeConcertController=Ember.ArrayController.extend({newConcert:{artist:"",venue:"",dateString:moment().format("DD.MM.YYYY")},actions:{addConcert:function(){var a=this.get("newConcert");if(a){var b=this.store.createRecord("concert",{artist:a.artist,venue:a.venue,date:a.dateString});b.save();{this.store.find("concerts","concerts_1").then(function(a){a.get("allConcerts").then(function(a){a.pushObject(b),a.save()})})}this.set("newConcert",{artist:"",venue:"",dateString:moment().format("DD.MM.YYYY")})}},removeConcert:function(a){a.deleteRecord(),a.save()}}})}(),function(){Concertember.ApplicationAdapter=DS.FixtureAdapter}(),function(){var a=DS.attr,b=(DS.belongsTo,DS.hasMany);Concertember.Concerts=DS.Model.extend({loveConcerts:b("concert",{async:!0}),maybeConcerts:b("concert",{async:!0}),allConcerts:b("concert",{async:!0})}),Concertember.Concert=DS.Model.extend({artist:a("string"),venue:a("string"),date:a("string")}),Concertember.Concert.FIXTURES=[{id:"concert_1",artist:"Blind Guardian",venue:"Philipshalle",date:moment().subtract(2,"days").format("DD.MM.YYYY")},{id:"concert_2",artist:"The Saddest Landscape",venue:"Turock",date:moment().format("DD.MM.YYYY")},{id:"concert_3",artist:"Spaceman Spiff",venue:"FFT",date:moment().format("DD.MM.YYYY")}],Concertember.Concerts.FIXTURES=[{id:"concerts_1",loveConcerts:["concert_1"],allConcerts:["concert_2"],maybeConcerts:["concert_3"]}]}(),function(){Concertember.ApplicationRoute=Ember.Route.extend({controllerName:"concert",model:function(){return this.store.find("concerts","concerts_1")}})}(),function(){Ember.Handlebars.registerBoundHelper("formatDate",function(a){return a})}(),function(){Concertember.ConcertCollectionView=Ember.CollectionView.extend({itemViewClass:Ember.View.extend({alertClass:function(){var a=function(a){return moment(a,"DD.MM.YYYY").isBefore(moment())},b=function(b){return moment().add(15,"days").isAfter(moment(b,"DD.MM.YYYY"))&&!a(b)},c=this.get("content.date");return b(c)?"bg-warning":a(c)?"bg-danger":"bg-primary"}.property("content.date")})})}(),function(){DragNDrop=Ember.Namespace.create(),DragNDrop.cancel=function(a){return a.preventDefault(),!1},DragNDrop.Dragable=Ember.Mixin.create({attributeBindings:"draggable",draggable:"true",dragStart:function(a){var b=a.originalEvent.dataTransfer,c=this.get("parentView.content.id"),d=this.get("parentView.parentView.content.content.name");b.setData("concertId",c),b.setData("concertListName",d)}}),DragNDrop.Droppable=Ember.Mixin.create({dragEnter:DragNDrop.cancel,dragOver:DragNDrop.cancel,drop:function(a){var b=a.originalEvent.dataTransfer.getData("concertId"),c=a.originalEvent.dataTransfer.getData("concertListName"),d=this.get("controller").get("store"),e=this.get("childViews")[0].content.content;return d.find("concert",b).then(function(a){e.pushObject(a),e.save();d.find("concerts","concerts_1").then(function(b){b.get(c).then(function(b){b.removeObject(a),b.save()})})}),a.preventDefault(),console.log("Dropping"),!1}}),Concertember.Box=Ember.View.extend(DragNDrop.Dragable),Concertember.DropTarget=Ember.View.extend(DragNDrop.Droppable)}(),function(){Concertember.Router.map(function(){})}();